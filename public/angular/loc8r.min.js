(function(){angular.module("loc8rApp",["ngRoute","ngSanitize","ui.bootstrap"]);function o(o,e){o.when("/",{templateUrl:"home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/about",{templateUrl:"/common/views/genericText.view.html",controller:"aboutCtrl",controllerAs:"vm"}).when("/location/:locationid",{templateUrl:"/locationDetail/locationDetail.view.html",controller:"locationDetailCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});e.html5Mode({enabled:true,requireBase:false})}angular.module("loc8rApp").config(["$routeProvider","$locationProvider",o])})();(function(){angular.module("loc8rApp").controller("homeCtrl",o);o.$inject=["$scope","loc8rData","geolocation"];function o(o,e,t){var n=this;n.pageHeader={title:"Loc8r",strapline:"Find places to work with wifi near you!"};n.sidebar={content:"Looking for wifi and a seat? Loc8r will help you out!"};n.message="Checking your location";n.getData=function(o){var t=o.coords.latitude,r=o.coords.longitude;n.message="Searching for nearby places";e.locationByCoords(t,r).success(function(o){n.message=o.length>0?"":"No locations found nearby";n.data={locations:o}}).error(function(o){n.message="Sorry, something's gone wrong"})};n.showError=function(e){o.$apply(function(){n.message=e.message})};n.noGeo=function(){o.$apply(function(){n.message="Geolocation is not supported by this browser"})};t.getPosition(n.getData,n.showError,n.noGeo)}})();(function(){angular.module("loc8rApp").controller("locationDetailCtrl",o);o.$inject=["$routeParams","$uibModal","loc8rData"];function o(o,e,t){var n=this;n.locationid=o.locationid;t.locationById(n.locationid).success(function(o){n.data={location:o};n.pageHeader={title:n.data.location.name}}).error(function(o){console.log(o)});n.popupReviewForm=function(){var o=e.open({templateUrl:"/reviewModal/reviewModal.view.html",controller:"reviewModalCtrl as vm",resolve:{locationData:function(){return{locationid:n.locationid,locationName:n.data.location.name}}}});o.result.then(function(o){n.data.location.reviews.push(o)})}}})();(function(){angular.module("loc8rApp").controller("aboutCtrl",o);function o(){var o=this;o.pageHeader={title:"About Loc8r"};o.main={content:"Loc8r was created to help people find places to sit and work \n\n Lorem ipsum dolor sic amet consectetur idipiscing elit. Nunc sed lorem ac nisi dignissim acumsan. \n\n Lorem ipsum dolor sic amet consectetur idipiscing elit. Nunc sed lorem ac nisi dignissim acumsan. \n\n Lorem ipsum dolor sic amet consectetur idipiscing elit. Nunc sed lorem ac nisi dignissim acumsan."}}})();(function(){angular.module("loc8rApp").controller("reviewModalCtrl",o);o.$inject=["$uibModalInstance","locationData","loc8rData"];function o(o,e,t){var n=this;n.formData={};n.locationData=e;n.modal={cancel:function(){o.dismiss("cancel")},close:function(e){o.close(e)}};n.onSubmit=function(){n.formError="";if(!n.formData.name||!n.formData.rating||!n.formData.reviewText){n.formError="All fields required, please try again.";return false}else{console.log(n.formData);n.doAddReview(n.locationData.locationid,n.formData)}};n.doAddReview=function(o,e){t.addReviewById(o,{author:e.name,rating:e.rating,reviewText:e.reviewText}).success(function(o){n.modal.close(o)}).error(function(o){n.formError="Your review has not been saved. Try again"});return false}}})();(function(){angular.module("loc8rApp").service("geolocation",o);function o(){var o=function(o,e,t){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(o,e)}else{t()}};return{getPosition:o}}})();(function(){angular.module("loc8rApp").service("loc8rData",o);o.$inject=["$http"];function o(o){var e=function(e,t){return o.get("/api/locations?lng="+t+"&lat="+e+"&maxDistance=20000")};var t=function(e){return o.get("/api/locations/"+e)};var n=function(e,t){return o.post("/api/locations/"+e+"/reviews",t)};return{locationByCoords:e,locationById:t,addReviewById:n}}})();(function(){angular.module("loc8rApp").filter("formatDistance",e);var o=function(o){return!isNaN(parseFloat(o))&&isFinite(o)};function e(){return function(e){var t,n;if(e&&o(e)){if(e>=1e3){t=parseFloat((e/1e3).toFixed(1));n=" km"}else{t=parseInt(e,10);n=" m"}return t+n}else{return"?"}}}})();(function(){angular.module("loc8rApp").filter("addHtmlLineBreaks",o);function o(){return function(o){var e=o.replace(/\n/g,"<br/>");return e}}})();(function(){angular.module("loc8rApp").directive("ratingStars",o);function o(){return{restrict:"EA",scope:{thisRating:"=rating"},templateUrl:"/common/directives/ratingStars/rating-stars.html"}}})();(function(){angular.module("loc8rApp").directive("footerGeneric",o);function o(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric/footerGeneric.template.html"}}})();(function(){angular.module("loc8rApp").directive("pageHeader",o);function o(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader/pageHeader.template.html"}}})();(function(){angular.module("loc8rApp").directive("navigation",o);function o(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html"}}})();